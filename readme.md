# html-tag-validator
This library takes some HTML source code, provided as a string, and generate an
AST. An error will be thrown describing what is malformed in the source document
if the AST cannot be generated.

The parser implements the basic components of the HTML 5 spec, such as:
 - `doctype` definition
 - HTML 5 elements
 - HTML 5 attributes
 - Enhanced validation for `script`, `style`, `link` and `meta` elements
 - Basic support for `iframe` elements
 - HTML comments

	  ``` html
	  <!--This is a comment. Comments are not displayed in the browser-->
	  ```

 - Conditional comments

	  ``` html
	  <!--[if gte mso 12]>
	    <style>
	      td {
	        mso-line-height-rule: exactly;
	      }
	    </style>
	  <![endif]-->
	  ```

 - Allowed `<input>` element `type` values and the attributes supported by each `type`
 - Hierarchal rules, such as: a properly-formed HTML 5 document should have a `<title>` element with contents
 - Void elements

  ``` html
  <img src="cat.gif">
  ```

 - Void elements

 ``` html
 <script async></script>
```

 - Normal elements

 ``` html
 <p class="foo"></p>
 ```

Note: this project is work-in-progress and is **not full spec-compliant**.

See `todo.md` for plans for current and future releases

## Install

```
npm install html-tag-validator
```

## Usage

The library exposes a single function that accepts two arguments: a string
containing HTML, and a callback function. The callback should be in the form:

``` javascript
function (err, ast) {
	if (err) {
		// View the error generated by the parser
		console.log(err.message);
	} else {
		// View a the AST generated by the parser
		console.log(JSON.stringify(ast));
	}
}
```

### Default syntax

``` javascript
var htmlTagValidator = require('html-tag-validator'),
	sampleHtml = "<html>" +
			 	 "<head><title>hello world</title></head>" +
				 "<body><p style='color: pink;'>my cool page</p></body>" +
				 "</html>";

// Turn a HTML string into an AST
htmlTagValidator(sampleHtml, function (err, ast) {
if (err) {
	throw new Error(err);
} else {
	console.log(ast);
}
});
```

Produces the following AST:

```
doctype:  null
document:
  -
    type:       element
    void:       false
    name:       html
    attributes: {}

    children:
      -
        type:       element
        void:       false
        name:       head
        attributes: {}

        children:
          -
            type:       title
            attributes: {}

            contents:   hello world
      -
        type:       element
        void:       false
        name:       body
        attributes: {}

        children:
          -
            type:       element
            void:       false
            name:       p
            attributes:
              style: color: pink;
            children:
              -
                type:     text
                contents: my cool page
```

### Passing in options

``` javascript
var htmlTagValidator = require('html-tag-validator'),
	sampleHtml = "<html>" +
				 "<head><title>hello world</title></head>" +
				 "<body><p (click)='myCoolFunc()'>my cool page</p></body>" +
				 "</html>";

/*
* Allow Angular 2 style attributes on all elements. The key '_' means match
* on ANY tag, but you could also specific specific tag names (e.g.:
* 'my-custom-tag'). Custom attributes for existing HTML 5 tags will be merged
* with the official list of allowed tags. The key 'mixed' means normal or void
* attributes for the given tag name. You can also specify to target all 'normal'
* and/or 'void' attributes.
*
* This options object says the following:
* for all existing HTML 5 tag names '_' ...
* allow the following types of attribute names
*   1) ng-*
*   2) (*)  
*   3) [*]  
* for void (e.g.: async) attributes OR
* normal attributes (e.g.: checked="checked") ...
* in addition to the standard HTML 5 attributes for the element.
*
* The second addition is to allow a normal attribute named 'name' to be
* added to the tag 'nw-nav-item' in addition to all the HTML 5 global
* and event attributes. By default, unknown tags will accept the global
* and event attributes. This addition will allow for a tag with the
* following definition:
* <nw-nav-item name="nav1">Home</nw-nav-item>
*/
htmlTagValidator(sampleHtml, {
'attributes': {
	'_': {
		'mixed': [/^((ng\-)|(^\[[\S]+\]$)|(^\([\S]+\)$))/]
	},
	'nw-nav-item': {
		'normal': 'name'
	}
}
}, function (err, ast) {
if (err) {
	throw new Error(err);
} else {
	console.log(ast);
}
});
```

``` javascript
var htmlTagValidator = require('html-tag-validator'),
	sampleHtml = "<html>" +
				 "<head><title>hello world</title></head>" +
				 "<body><p (click)='myCoolFunc()'>my cool page</p></body>" +
				 "</html>";

/*
* Allow old-style HTML table attributes on specific elements.
*
* This options object adds some old HTML attributes for tables, to
* the 'table' and 'td' elements, in addition to the standard HTML 5
* attributes. Because the key is 'normal', these attributes are
* validated as normal attributes that should have a defined value.
* <td height="20px" width="30px">One</td>
* <td bgcolor="#000000">Two</td>
*/
htmlTagValidator(sampleHtml, {
'attributes': {
	'table': {
		'normal': ['align', 'bgcolor', 'border', 'cellpadding', 'cellspacing', 'frame', 'rules', 'summary', 'width']
	},
	'td': {
		'normal': ['height', 'width', 'bgcolor']
	}
}
}, function (err, ast) {
if (err) {
	throw new Error(err);
} else {
	console.log(ast);
}
});
```
